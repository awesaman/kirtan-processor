# Build Tools Documentation

This directory contains scripts to help build and package the Kirtan Processor application into executable files. These tools make it easy to create distributable versions of the application with proper icons and resources.

## Available Tools by Operating System

### Windows (.exe)

#### `create_exe.py`

The primary Python script for creating a Windows executable. This script:
- Automatically creates a default icon if none exists (blue circle on white background)
- Packages the application as a single-file executable using PyInstaller
- Includes necessary resources like images and style.qss
- Creates the executable with no console window (GUI only)
- Names the output as "KirtanProcessor.exe"
- Places the output in the `dist` folder in the project root

**Usage:**
```
python create_exe.py
```

#### `create_exe.bat`

A simple batch script for creating a Windows executable with default settings. This script:
- Uses PyInstaller to create a single-file executable
- Hides the console window when the app runs
- Names the output as "KirtanProcessor.exe"
- Does not include an icon by default

**Usage:**
```
create_exe.bat
```

#### `create_exe_advanced.bat`

An advanced batch script with interactive prompts to customize the Windows executable creation. This script:
- Allows specifying a custom icon path
- Gives options to include additional data folders
- Lets you choose whether to show a console window
- Displays the full PyInstaller command being executed

**Usage:**
```
create_exe_advanced.bat
```

#### `rebuild_exe_clean.bat`

A special batch script for rebuilding the Windows executable from scratch. This script:
- Removes any existing spec file
- Uses explicit absolute paths for all resources
- Shows diagnostic information to help identify path issues
- Performs detailed checks before building the executable
- Useful for troubleshooting when other build methods fail

**Usage:**
```
rebuild_exe_clean.bat
```

#### `rebuild_exe_clean.py`

A Python script alternative to rebuild_exe_clean.bat with even more robust path handling. This script:
- Works more reliably across different environments
- Provides detailed diagnostics of paths and file availability
- Has better error handling and reporting
- Is recommended when the batch script fails due to path issues

**Usage:**
```
python rebuild_exe_clean.py
```

### macOS (.app/.dmg)

#### `create_mac_app.py`

A Python script for creating macOS application bundles (.app) and disk images (.dmg). This script:
- Creates an .icns icon file from existing icons or generates a new one
- Packages the application as a macOS .app bundle using PyInstaller
- Optionally creates a .dmg installer for easy distribution
- Includes necessary resources like images and style.qss
- Must be run on macOS for full functionality

**Usage (on macOS):**
```
python create_mac_app.py
```

#### `create_mac_app.bat`

A batch script wrapper for Windows users who want to create macOS applications. This script:
- Provides information about macOS requirements
- Runs the create_mac_app.py script in simulation mode
- Explains steps to complete the build process on a macOS system

**Usage (on Windows):**
```
create_mac_app.bat
```

## Cross-Platform Tools

### Icon Creation Tools

#### `create_icon.py`

Creates a basic icon file (app_icon.ico) in the project root. This script:
- Generates a simple icon with a white background
- Creates a blue circle as the icon design
- Works on all platforms with Python and Pillow installed

**Usage:**
```
python create_icon.py
```

#### `create_icon_from_png.py`

Converts an existing PNG image to an icon file. This script:
- Takes a PNG image (by default from the images folder)
- Converts it to the ICO format suitable for Windows applications
- Saves it as app_icon.ico in the project root
- Works on all platforms with Python and Pillow installed

**Usage:**
```
python create_icon_from_png.py
```

#### `create_simple_icon.py` and `create_simple_icon_v2.py`

Alternative scripts for creating simple icon files with basic shapes:
- Similar to create_icon.py but with different design elements
- Work on all platforms with Python and Pillow installed

**Usage:**
```
python create_simple_icon.py
```

### Configuration Files

#### `KirtanProcessor.spec`

The PyInstaller specification file that defines how the Kirtan Processor executable should be built. This file:
- Contains settings for the PyInstaller build process
- Defines the executable name, console visibility, and other properties
- Is automatically generated by PyInstaller but can be manually edited to customize the build process
- Can be directly used with PyInstaller by running `pyinstaller KirtanProcessor.spec`
- Works for both Windows and macOS builds

**Usage:**
```
pyinstaller KirtanProcessor.spec
```

## Workflow Guide

### Windows Build Workflow

1. Create an icon (optional):
   ```
   python create_icon_from_png.py
   ```
   This will create app_icon.ico in the project root.

2. Create the executable:
   ```
   python create_exe.py
   ```
   Or for more options:
   ```
   create_exe_advanced.bat
   ```

3. Find the resulting executable in the `dist` folder in the project root.

### macOS Build Workflow

1. Transfer the project to a macOS system

2. Install required dependencies:
   ```
   pip install pyinstaller pillow
   brew install create-dmg
   ```

3. Run the macOS build script:
   ```
   python create_mac_app.py
   ```

4. Find the resulting .app bundle and .dmg installer in the `dist` folder.

## Troubleshooting

### Style.qss Not Included in Windows Executable

If the application's UI styling is missing when running the executable, this indicates that the `style.qss` file wasn't properly included in the build. Use the following steps to fix it:

1. Verify the issue with the check_style_inclusion.py script:
   ```
   python check_style_inclusion.py
   ```
   
2. Rebuild the executable with a fresh spec file:
   ```
   # Delete the old spec file
   del KirtanProcessor.spec
   
   # Rebuild with explicit style.qss inclusion
   python create_exe.py
   ```

3. Verify the style.qss is now included in the new executable:
   ```
   python check_style_inclusion.py
   ```

### Path Issues When Building Executable

If you see errors like "script 'C:\path\to\Kirtan-Processor-gui.py' not found" when building the executable, this indicates a path resolution issue. To fix it:

1. Use the clean rebuild script that uses explicit paths:
   ```
   rebuild_exe_clean.bat
   ```

2. Check the console output for path information to confirm the correct paths are being used.

3. If issues persist, ensure you're running the build script from the build-tools directory.

#### Common Path Issues:

- **Incorrect Working Directory**: Always run the build scripts from within the build-tools folder
- **Relative vs Absolute Paths**: The clean rebuild script uses absolute paths to avoid this problem
- **Spec File Path Issues**: If you see path errors, try removing the spec file and rebuilding

### Checking Resource Inclusion

#### `check_style_inclusion.py`

A utility script to verify if style.qss is properly included in the executable. This script:
- Inspects the executable file structure
- Searches for style.qss in the packaged resources
- Reports whether the style file was found
- Helps diagnose packaging issues

**Usage:**
```
python check_style_inclusion.py [path_to_executable]
```

## Requirements

- Python 3.9 or higher
- PyInstaller (install with `pip install pyinstaller`)
- Pillow (install with `pip install pillow`) - required for icon creation scripts
- create-dmg (macOS only, install with `brew install create-dmg`) - for creating DMG installers
